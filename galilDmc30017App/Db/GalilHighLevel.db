######################################################################
#
#            Galil DMC 30017 High Level Record Database
#
# Desc: These records provide an abstraction layer for
# the Galil Driver records.

#####################################################################
# ALIASES
#
# Desc: Aliases for the Galil Driver records.

# Motor Record
# Source: <Galil support top directory>/GalilSup/Db/galil_motor.template
alias(  "$(P)$(M)",                       "$(P)Mtr")                    # Standard Motor record which groups many of the motor's features

# DMC Control records
# Source: <Galil support top directory>/GalilSup/Db/galil_dmc_ctrl.template
alias(  "$(P)MODEL_MON",                  "$(P)ControllerModel-Mon")    # Controller model monitor
alias(  "$(P)ADDRESS_MON",                "$(P)ControllerAddr-Mon")     # Controller address monitor
alias(  "$(P)LIMITTYPE_STATUS",           "$(P)LimSwType-Sts")          # Limit switch type configuration (read)
alias(  "$(P)LIMITTYPE_CMD",              "$(P)LimSwType-Sel")          # Limit switch type configuration (set)
alias(  "$(P)HOMETYPE_STATUS",            "$(P)HomeSwType-Sts")         # Home switch type configuration (read)
alias(  "$(P)HOMETYPE_CMD",               "$(P)HomeSwType-Sel")         # Home switch type configuration (set)
alias(  "$(P)ETHADDR_MON",                "$(P)MacAddr-Mon")            # Controller MAC address monitor
alias(  "$(P)SERIALNUM_MON",              "$(P)SerialNr-Mon")           # Controller serial number monitor
alias(  "$(P)COMMERR_STATUS",             "$(P)CommErr-Mon")            # Communication Error monitor
alias(  "$(P)START_STATUS",               "$(P)ControllerStart-Mon")    # Controller startup status monitor
alias(  "$(P)DEFER_STATUS",               "$(P)DeferredMove-Sts")       # Deferred moves option (read)
alias(  "$(P)DEFER_CMD",                  "$(P)DeferredMove-Sel")       # Deferred moves option (set)
alias(  "$(P)UPLOAD_CMD",                 "$(P)UploadUserArray-Cmd")    # Upload user array command
alias(  "$(P)UPLOAD_STATUS",              "$(P)UploadUserArray-Mon")    # Array upload status monitor
alias(  "$(P)DEFER_MODE_STATUS",          "$(P)DeferredMoveMode-Sts")   # Deferred move mode (read)
alias(  "$(P)DEFER_MODE_CMD",             "$(P)DeferredMoveMode-Sel")   # Deferred move mode (set)
alias(  "$(P)ERROR_MON",                  "$(P)ControllerErr-Mon")      # Controller error monitor
alias(  "$(P)SEND_STR_CMD",               "$(P)Send-Cmd")               # Send a command string to the controller
alias(  "$(P)SEND_STR_MON",               "$(P)Response-Mon")           # Last response string received after sending a command to the controller using "Send-Cmd"
alias(  "$(P)SEND_STRVAL_MON",            "$(P)ReponseVal-Mon")         # Display last response received when it is a number

# Extra features not provided by Motor Record
# Source: <Galil support top directory>/GalilSup/Db/galil_motor_extras.template
alias(  "$(P)$(M)_ESTALL_STATUS",         "$(P)Estall-Sts")             # Encoder stall status
alias(  "$(P)$(M)_ESTALLTIME_MON",        "$(P)EstallTime-RB")          # Estall time read
alias(  "$(P)$(M)_ESTALLTIME_SP",         "$(P)EstallTime-SP")          # Estall time set
alias(  "$(P)$(M)_STEPSMOOTH_MON",        "$(P)StepSmooth-RB")          # Step smoothing read
alias(  "$(P)$(M)_STEPSMOOTH_SP",         "$(P)StepSmooth-SP")          # Step smoothing set
alias(  "$(P)$(M)_MCONN_STATUS",          "$(P)MtrConnect-Mon")         # Connection status
alias(  "$(P)$(M)_UINDEX_STATUS",         "$(P)UseIdx-Sts")             # Use encoder index when homing (read)
alias(  "$(P)$(M)_UINDEX_CMD",            "$(P)UseIdx-Sel")             # Use encoder index when homing (set)
alias(  "$(P)$(M)_USWITCH_STATUS",        "$(P)UseSw-Sts")              # Use limit switch when homing (read)
alias(  "$(P)$(M)_USWITCH_CMD",           "$(P)UseSw-Sel")              # Use limit switch when homing (set)
alias(  "$(P)$(M)_USERDATA_MON",          "$(P)UserData-Mon")           # User data (read)
alias(  "$(P)$(M)_USERDATADEADB_SP",      "$(P)UserDataDeadBand-SP")    # User data deadband (set)
alias(  "$(P)$(M)_JAH_STATUS",            "$(P)JogAfterHome-Sts")       # Jog after home (read)
alias(  "$(P)$(M)_JAH_CMD",               "$(P)JogAfterHome-Sel")       # Jog after home (set)
alias(  "$(P)$(M)_JAHV_MON",              "$(P)JogAfterHome-RB")        # Jog after home to position (read)
alias(  "$(P)$(M)_JAHV_SP",               "$(P)JogAfterHome-SP")        # Jog after home to position (set)
alias(  "$(P)$(M)_EGUAFTLIMIT_MON",       "$(P)EguAfterLim-RB")         # EGU after limit (read)
alias(  "$(P)$(M)_EGUAFTLIMIT_SP",        "$(P)EguAfterLim-SP")         # EGU after limit (set)
alias(  "$(P)$(M)_STATUS_POLL_DELAY_CMD", "$(P)PollFreq-SP")            # Control poll frequency for axis and encoder status (read)
alias(  "$(P)$(M)_STATUS_POLL_DELAY_MON", "$(P)PollFreq-RB")            # Control poll frequency for axis and encoder status (set)
alias(  "$(P)$(M)_HOMEALLOWED_CMD",       "$(P)HomeEnblDir-Sel")        # Enable directions for homing (set)
alias(  "$(P)$(M)_HOMEALLOWED_STATUS",    "$(P)HomeEnblDir-Sts")        # Enable directions for homing (read)
alias(  "$(P)$(M)_STOPDELAY_MON",         "$(P)StopDelay-RB")           # Motor stop delay (read)
alias(  "$(P)$(M)_STOPDELAY_SP",          "$(P)StopDelay-SP")           # Motor stop delay (set)
alias(  "$(P)$(M)_AMPGAIN_CMD",           "$(P)AmpGain-Sel")            # Amplifier gain (set)
alias(  "$(P)$(M)_AMPGAIN_STATUS",        "$(P)AmpGain-Sts")            # Amplifier gain (read)
alias(  "$(P)$(M)_AMPCLGAIN_CMD",         "$(P)AmpCurrLoopGain-Sel")    # Amplifier current loop gain (set)
alias(  "$(P)$(M)_AMPCLGAIN_STATUS",      "$(P)AmpCurrLoopGain-Sts")    # Amplifier current loop gain (read)
alias(  "$(P)$(M)_AMPLC_SP",              "$(P)LowCurrMode-SP")         # Specify period before going to low curr mode, or disable low curr mode for n=0 (set)
alias(  "$(P)$(M)_AMPLC_MON",             "$(P)LowCurrMode-RB")         # Specify period before going to low curr mode, or disable low curr mode for n=0 (read)
alias(  "$(P)$(M)_ERRLIMIT_SP",           "$(P)PosErrLim-SP")           # Position error limit in counts (set)
alias(  "$(P)$(M)_ERRLIMIT_MON",          "$(P)PosErrLim-RB")           # Position error limit in counts (read)
alias(  "$(P)$(M)_ERR_MON",               "$(P)PosErr-Mon")             # Position error monitor
alias(  "$(P)$(M)_VELOCITYRAW_MON",       "$(P)VeloRaw-Mon")            # Velocity monitor in counts/second
alias(  "$(P)$(M)_VELOCITYEGU_MON",       "$(P)VeloEgu-Mon")            # Velocity monitor in engineering units
alias(  "$(P)$(M)_OFFONERR_CMD",          "$(P)ErrLimType-Sel")         # Error state source (set)
alias(  "$(P)$(M)_OFFONERR_STATUS",       "$(P)ErrLimType-Sts")         # Error state source (read)
alias(  "$(P)$(M)_AXIS_STATUS",           "$(P)Axis-Mon")               # Selected Axis monitor
alias(  "$(P)$(M)_MTRTYPE_CMD",           "$(P)MtrType-Sel")            # Motor type (set)
alias(  "$(P)$(M)_MTRTYPE_STATUS",        "$(P)MtrType-Sts")            # Motor type (read)
alias(  "$(P)$(M)_MENCTYPE_CMD",          "$(P)MainEncType-Sel")        # Main encoder type (set)
alias(  "$(P)$(M)_MENCTYPE_STATUS",       "$(P)MainEncType-Sts")        # Main encoder type (read)
alias(  "$(P)$(M)_AENCTYPE_CMD",          "$(P)AuxEncType-Sel")         # Auxiliar encoder typw (set)
alias(  "$(P)$(M)_AENCTYPE_STATUS",       "$(P)AuxEncType-Sts")         # Auxiliar encoder typw (read)
alias(  "$(P)$(M)_WLP_CMD",               "$(P)LimProtectEnbl-Sel")     # Limit protection enable (set)
alias(  "$(P)$(M)_WLP_STATUS",            "$(P)LimProtectEnbl-Sts")     # Limit protection enable (read)
alias(  "$(P)$(M)_WLPACTIVE_STATUS",      "$(P)LimProtect-Mon")         # Limit protection state monitor
alias(  "$(P)$(M)_AUTOONOFF_CMD",         "$(P)AutoOnOff-Sel")          # Motor auto power on/off between moves (set)
alias(  "$(P)$(M)_AUTOONOFF_STATUS",      "$(P)$(P)AutoOnOff-Sts")      # Motor auto power on/off between moves (read)
alias(  "$(P)$(M)_ONDELAY_MON",           "$(P)AutoOnDelay-RB")         # Motor auto power on delay (read)
alias(  "$(P)$(M)_ONDELAY_SP",            "$(P)AutoOnDelay-SP")         # Motor auto power on delay (set)
alias(  "$(P)$(M)_OFFDELAY_MON",          "$(P)AutoOffDelay-RB")        # Motor auto power off delay (read)
alias(  "$(P)$(M)_OFFDELAY_SP",           "$(P)AutoOffDelay-SP")        # Motor auto power off delay (set)
alias(  "$(P)$(M)_BRAKE_CMD",             "$(P)Brake-Cmd")              # Motor brake manual control (set)
alias(  "$(P)$(M)_BRAKE_STATUS",          "$(P)Brake-Mon")              # Motor brake manual control (read)
alias(  "$(P)$(M)_AUTOBRAKE_CMD",         "$(P)AutoBrakeEnbl-Sel")      # Motor auto brake enable (set)
alias(  "$(P)$(M)_AUTOBRAKE_STATUS",      "$(P)AutoBrakeEnbl-Sts")      # Motor auto brake enable (read)
alias(  "$(P)$(M)_BRAKEPORT_MON",         "$(P)AutoBrakeiDigPort-RB")   # Motor brake digital port (read)
alias(  "$(P)$(M)_BRAKEPORT_SP",          "$(P)AutoBrakeDigPort-SP")    # Motor brake digital port (set)
alias(  "$(P)$(M)_BRAKEONDELAY_MON",      "$(P)AutoBrakeDelay-RB")      # Motor auto brake on delay (read)
alias(  "$(P)$(M)_BRAKEONDELAY_SP",       "$(P)AutoBrakeDelay-SP")      # Motor auto brake on delay (set)
alias(  "$(P)$(M)_LIMITDISABLE_CMD",      "$(P)LimSwDsbl-Sel")          # Disable limit switches mode (set)
alias(  "$(P)$(M)_LIMITDISABLE_STATUS",   "$(P)LimSwDsbl-Sts")          # Disable limit switches mode (read)
alias(  "$(P)$(M)_ON_STATUS",             "$(P)AmpEnbl-Sts")            # Turn galil amplifier on/off (read)
alias(  "$(P)$(M)_ON_CMD",                "$(P)AmpEnbl-Sel")            # Turn galil amplifier on/off (set)

# Digital outputs control
# Source: <Galil support top directory>/GalilSup/Db/galil_digital_out_bit.template
alias(  "$(P)$(DIG_OUT0)_STATUS",         "$(P)$(DIG_OUT0)-Sts")        # Digital output bit 0 state (read)
alias(  "$(P)$(DIG_OUT0)_CMD",            "$(P)$(DIG_OUT0)-Sel")        # Digital output bit 0 state (set)
alias(  "$(P)$(DIG_OUT1)_STATUS",         "$(P)$(DIG_OUT1)-Sts")        # Digital output bit 1 state (read)
alias(  "$(P)$(DIG_OUT1)_CMD",            "$(P)$(DIG_OUT1)-Sel")        # Digital output bit 1 state (set)
alias(  "$(P)$(DIG_OUT2)_STATUS",         "$(P)$(DIG_OUT2)-Sts")        # Digital output bit 2 state (read)
alias(  "$(P)$(DIG_OUT2)_CMD",            "$(P)$(DIG_OUT2)-Sel")        # Digital output bit 2 state (set)
alias(  "$(P)$(DIG_OUT3)_STATUS",         "$(P)$(DIG_OUT3)-Sts")        # Digital output bit 3 state (read)
alias(  "$(P)$(DIG_OUT3)_CMD",            "$(P)$(DIG_OUT3)-Sel")        # Digital output bit 3 state (set)

# Digital inputs control
# Source: <Galil support top directory>/GalilSup/Db/galil_digital_in_bit.template
alias(  "$(P)$(DIG_IN0)_STATUS",          "$(P)$(DIG_IN0)-Mon")        # Digital input bit 0 monitor
alias(  "$(P)$(DIG_IN1)_STATUS",          "$(P)$(DIG_IN1)-Mon")        # Digital input bit 1 monitor
alias(  "$(P)$(DIG_IN2)_STATUS",          "$(P)$(DIG_IN2)-Mon")        # Digital input bit 2 monitor
alias(  "$(P)$(DIG_IN3)_STATUS",          "$(P)$(DIG_IN3)-Mon")        # Digital input bit 3 monitor
alias(  "$(P)$(DIG_IN4)_STATUS",          "$(P)$(DIG_IN4)-Mon")        # Digital input bit 4 monitor
alias(  "$(P)$(DIG_IN5)_STATUS",          "$(P)$(DIG_IN5)-Mon")        # Digital input bit 5 monitor
alias(  "$(P)$(DIG_IN6)_STATUS",          "$(P)$(DIG_IN6)-Mon")        # Digital input bit 6 monitor
alias(  "$(P)$(DIG_IN7)_STATUS",          "$(P)$(DIG_IN7)-Mon")        # Digital input bit 7 monitor

# Analog outputs control
# Source: <Galil support top directory>/GalilSup/Db/galil_analog_out.template
alias(  "$(P)$(ANALOG_OUT0)_MON",         "$(P)$(ANALOG_OUT0)-RB")     # Analog output 0 state (read)
alias(  "$(P)$(ANALOG_OUT0)_SP",          "$(P)$(ANALOG_OUT0)-SP")     # Analog output 0 state (set)
alias(  "$(P)$(ANALOG_OUT0)Deadb_SP",     "$(P)$(ANALOG_OUT0)DeadBand-SP")     # Analog output 0 deadband state (set)
alias(  "$(P)$(ANALOG_OUT0)Deadb_SP",     "$(P)$(ANALOG_OUT0)DeadBand-RB")     # Analog output 0 deadband dummy readback

alias(  "$(P)$(ANALOG_OUT1)_MON",         "$(P)$(ANALOG_OUT1)-RB")     # Analog output 1 state (read)
alias(  "$(P)$(ANALOG_OUT1)_SP",          "$(P)$(ANALOG_OUT1)-SP")     # Analog output 1 state (set)
alias(  "$(P)$(ANALOG_OUT1)Deadb_SP",     "$(P)$(ANALOG_OUT1)DeadBand-SP")     # Analog output 1 deadband state (set)
alias(  "$(P)$(ANALOG_OUT1)Deadb_SP",     "$(P)$(ANALOG_OUT1)DeadBand-RB")     # Analog output 1 deadband dummy readback

# Analog inputs control
# Source: <Galil support top directory>/GalilSup/Db/galil_analog_in.template
alias(  "$(P)$(ANALOG_IN0)_MON",         "$(P)$(ANALOG_IN0)-Mon")     # Analog input 0 monitor
alias(  "$(P)$(ANALOG_IN0)Deadb_SP",     "$(P)$(ANALOG_IN0)DeadBand-SP")     # Analog input 0 deadband state (set)
alias(  "$(P)$(ANALOG_IN0)Deadb_SP",     "$(P)$(ANALOG_IN0)DeadBand-RB")     # Analog input 0 deadband dummy readback

alias(  "$(P)$(ANALOG_IN1)_MON",         "$(P)$(ANALOG_IN1)-Mon")     # Analog input 1 monitor
alias(  "$(P)$(ANALOG_IN1)Deadb_SP",     "$(P)$(ANALOG_IN1)DeadBand-SP")     # Analog input 1 deadband state (set)
alias(  "$(P)$(ANALOG_IN1)Deadb_SP",     "$(P)$(ANALOG_IN1)DeadBand-RB")     # Analog input 1 deadband dummy readback

#####################################################################
# HIGH LEVEL FEATURES
#
# Desc: Records that provide high level features to the IOC,
# in order to allow easy control of it.

# Specific motor position that should be stored
record(ao, "$(P)StoredPos-SP"){
  field(DESC, "Store position value")
  field(EGU, "$(EGU)")
  field(PREC, "6")
  field(OUT, "$(P)StoredPos-RB")
}

# Readback value of specific motor position stored
record(ai, "$(P)StoredPos-RB"){
  field(DESC, "Stored position value RB")
  field(EGU, "$(EGU)")
  field(PREC, "6")
}

# Command motor to go to the stored motor position
record(bo, "$(P)GoToStoredPos-Cmd"){
  field(DESC, "Move motor to stored position")
  field(ONAM, "On")
  field(ZNAM, "Off")
  field(HIGH, "0.5")
  field(FLNK, "$(P)TransferPos")
}

# Transfer stored value to motor record value
record(calcout, "$(P)TransferPos"){
  field(DESC, "Transfer stored position to motor")
  field(INPA, "$(P)StoredPos-RB")
  field(INPB, "$(P)GoToStoredPos-Cmd")
  field(CALC, "B")                                                    # Command state
  field(OCAL, "A")                                                    # Value to be transferred
  field(OOPT, "When Non-zero")
  field(DOPT, "Use OCAL")
  field(OUT, "$(P)$(M).VAL PP")                                       # Command motor to go to stored position
}

# Load stored motor position with encoder readback value
record(bo, "$(P)StoreEncPos-Cmd"){
  field(DESC, "Load stored position with encoder read")
  field(ONAM, "On")
  field(ZNAM, "Off")
  field(HIGH, "0.5")
  field(FLNK, "$(P)StoreEncPosCalc")
}

# Transfer encorder position (motor RBV) to stored position
record(calcout, "$(P)StoreEncPosCalc"){
  field(DESC, "Transfer encoder read to stored position")
  field(INPA, "$(P)$(M).RBV")
  field(INPB, "$(P)StoreEncPos-Cmd")
  field(CALC, "B")                                                    # Command state
  field(OCAL, "A")                                                    # Value to be transferred
  field(OOPT, "When Non-zero")
  field(DOPT, "Use OCAL")
  field(OUT, "$(P)StoredPos-SP PP")                                   # Transfer encoder position to stored position
}

# Reset Position After Homing
# This record is used by a sequencer state machine
record(bo, "$(P)RstPosAfterHome-Sel"){
  field(DESC, "Reset position after homing")
  field(ZNAM, "No")
  field(ONAM, "Yes")
  field(FLNK, "$(P)RstPosAfterHome-Sts")
}

# Reset Position After Homing status
# This record is used by a sequencer state machine
record(bi, "$(P)RstPosAfterHome-Sts"){
  field(DESC, "Reset position after homing status")
  field(ZNAM, "No")
  field(ONAM, "Yes")
  field(INP, "$(P)RstPosAfterHome-Sel")
}

#####################################################################
# HIGH LEVEL RECORDS FOR MOTOR FIELDS
#
# Desc: High Level records that fit the most relevant Motor Record
# fields into the Sirius Naming Standard.

# DIFF - Difference between motor DVAL and DRBV.
record(ai, "$(P)PosDiff-Mon"){
  field(DESC, "Encoder read and commanded position diff")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(INP, "$(P)$(M).DIFF CPP")
}

# DMOV - Done moving to value.
record(bi, "$(P)DoneMov-Mon"){
  field(DESC, "Motor is done moving flag")
  field(ZNAM, "No")
  field(ONAM, "Yes")
  field(INP, "$(P)$(M).DMOV CPP")
}

# HLS - At High Limit Switch.
record(bi, "$(P)HighLimSw-Mon"){
  field(DESC, "At high limit switch flag")
  field(ZNAM, "No")
  field(ONAM, "Yes")
  field(INP, "$(P)$(M).HLS CPP")
}

# HOME - Depending on DIR, move back to home using jog function
# Unlike the Home functions, the Jog functions adapt themselves to the DIR value
record(bo, "$(P)Home-Cmd"){
  field(DESC, "Homing command")
  field(ZNAM, "Off")
  field(ONAM, "On")
  field(HIGH, "0.5")
  field(FLNK, "$(P)HomeCalc")
}

# Validate the homing command
record(calcout, "$(P)HomeCalc"){
  field(DESC, "Home command calc")
  field(INPA, "$(P)Home-Cmd")
  field(CALC, "A=0?0:1")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(M).JOGR PP")
}

# LLS - At Low Limit Switch.
record(bi, "$(P)LowLimSw-Mon"){
  field(DESC, "At low limit switch flag")
  field(ZNAM, "No")
  field(ONAM, "Yes")
  field(INP, "$(P)$(M).LLS CPP")
}

# RBV - User Readback Value.
record(ai, "$(P)EncPos-Mon"){
  field(DESC, "Encoder position")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(INP, "$(P)$(M).RBV CPP")
}

# RLV - Relative Value.
record(ao, "$(P)MoveRelative-Cmd"){
  field(DESC, "Move a relative distance")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(OUT, "$(P)$(M).RLV PP")
}

# STOP - Stop Move.
record(bo, "$(P)Stop-Cmd"){
  field(DESC, "Stop motor command")
  field(ZNAM, "Off")
  field(ONAM, "On")
  field(HIGH, "0.5")
  field(FLNK, "$(P)StopCalc")
}

# Validate stop motor command
record(calcout, "$(P)StopCalc"){
  field(DESC, "Validate stop command")
  field(INPA, "$(P)Stop-Cmd")
  field(CALC, "A")
  field(OOPT, "When Non-zero")
  field(OUT, "$(P)$(M).STOP PP")
}

# TWF - Tweak motor Forward.
record(bo, "$(P)TweakFwd-Cmd"){
  field(DESC, "Move motor a tweak step size forward")
  field(ZNAM, "Off")
  field(ONAM, "On")
  field(HIGH, "0.5")
  field(OUT, "$(P)$(M).TWF PP")
}

# TWR - Tweak motor Reverse.
record(bo, "$(P)TweakBack-Cmd"){
  field(DESC, "Move motor a tweak step size back")
  field(ZNAM, "Off")
  field(ONAM, "On")
  field(HIGH, "0.5")
  field(OUT, "$(P)$(M).TWR PP")
}

# TWV - Tweak Step Size (EGU).
record(ao, "$(P)TweakStep-SP"){
  field(DESC, "Step size used in tweak moves")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(OUT, "$(P)$(M).TWV PP")
  field(FLNK, "$(P)TweakStep-RB")
}

# Tweak Step Size Readback
record(ai, "$(P)TweakStep-RB"){
  field(DESC, "Step size used in tweak moves RB")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(INP, "$(P)$(M).TWV CPP")
}

# VAL - User Desired Absolute Position Value.
record(ao, "$(P)AbsPos-SP"){
  field(DESC, "Move to an absolute position")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(OUT, "$(P)$(M).VAL PP")
}

# Absolute Position Readback Value.
record(ai, "$(P)AbsPos-RB"){
  field(DESC, "Absolute position RB")
  field(EGU, "$(EGU)")
  field(PREC, "$(PREC)")
  field(INP, "$(P)$(M).VAL CPP")
}

#####################################################################
# INITIALIZATION AND AUTO CONFIGURATION
#
# Desc: High Level initialization and auto-configuration operations.

# Auto update jog acceleration
# Since jog is used by high level for homing, it is the homing acceleration
record(calcout, "$(P)JogAccAutoConfig"){
  field(DESC, "Transform acc. period to jog acc.")
  field(INPA, "$(P)$(M).ACCL CPP")
  field(INPB, "$(P)$(M).VELO CPP")
  field(CALC, "B/A")
  field(OUT, "$(P)$(M).JAR PP")
}

record(seq, "$(P)AutoConfig"){
  field(DESC, "High level auto configuration")
  field(SELM, "All")
  field(DOL1, "$(P)$(M).VELO CPP")                                    # Motor velocity should be transferred to jog velocity
  field(LNK1, "$(P)$(M).JVEL PP")                                     # Jog acceleration <= motor acceleration
  field(PINI, "YES")
}
